<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dynamic Trend Counters with Individual Totals</title>
  <style>
    body {
      padding-top: 20px; /* Üstten boşluk ekle */
    }
    .input-number {
      font-size: 40px;
      text-align: center;
    }
    .mounter-container {
      display: flex;
      gap: 20px;
      margin-top: 15px;
      justify-content: center;
    }
    .mounter {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 1px solid #ddd;
      padding: 50px;
      border-radius: 5px;
      text-align: center;
      width: 100px;
    }
    button {
      touch-action: manipulation;
      font-size: 80px;
      text-align: center;
      height: 70px;
      width: 70px;
    }
    .reset-button {
      font-size: 20px;
      margin-left: 10px;
    }
    .total {
      font-size: 40px;
      text-align: center;
    }
    #overall-total {
      font-size: 80px;
      text-align: center;
    }
    .select-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    .select-container label {
      font-size: 24px;
      margin-bottom: 10px;
      display: block;
    }
    .select-container select {
      font-size: 24px;
      padding: 15px;
      border-radius: 5px;
      border: 1px solid #ddd;
      width: 250px;
    }
    .selected-items {
      text-align: center;
      font-size: 20px;
      margin-top: 10px;
    }
    #all-counters {
      display: none; /* Default olarak gizle */
    }
    #download-btn {
      font-size: 30px;
      padding: 15px 50px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #download-btn:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>

  <center>
    <div class="select-container">
      <div>
        <label for="select1">Select 1</label>
        <select id="select1" onchange="displaySelectedItems()">
          <option value="">Select...</option>
          <option value="BGA8 - Kadın Ayakkabı">BGA8 - Kadın Ayakkabı</option>
          <option value="BGB8 - Kadın Southblue">BGB8 - Kadın Southblue</option>
          <option value="BGC8 - Kadın Modest/Muhafazakar">BGC8 - Kadın Modest/Muhafazakar</option>
          <option value="BGD8 - Kadın Elbise">BGD8 - Kadın Elbise</option>
          <option value="BGE8 - Kadın Klasik">BGE8 - Kadın Klasik</option>
          <option value="BGF8 - Kadın Vison Mısır">BGF8 - Kadın Vison Mısır</option>
          <option value="BGF8 - KADIN DENİM DUVARI MISIR">BGF8 - KADIN DENİM DUVARI MISIR</option>
          <option value="BGG8 - Kadın Aktif Giyim">BGG8 - Kadın Aktif Giyim</option>
          <option value="BGH8 - Kadın Hamile">BGH8 - Kadın Hamile</option>
          <option value="BGI8 - Kadın İkinci El Ürün">BGI8 - Kadın İkinci El Ürün</option>
          <option value="BGJ8 - Kadın Denim">BGJ8 - Kadın Denim</option>
          <option value="BGK8 - Kadın Aksesuar">BGK8 - Kadın Aksesuar</option>
          <option value="BGL8 - Kadın Vision">BGL8 - Kadın Vision</option>
          <option value="BGM8 - Kadın Aktif Giyim">BGM8 - Kadın Aktif Giyim</option>
          <option value="BGN - Kadın Klasik NOS">BGN - Kadın Klasik NOS</option>
          <option value="BGO8 - Kadın Outlet Ürün">BGO8 - Kadın Outlet Ürün</option>
          <option value="BGP8 - Kadın Büyük Beden">BGP8 - Kadın Büyük Beden</option>
          <option value="BGQ8 - Kadın X-SIDE">BGQ8 - Kadın X-SIDE</option>
          <option value="BGR8 - Kadın Çorap">BGR8 - Kadın Çorap</option>
          <option value="BGS8 - Kadın İç Giyim">BGS8 - Kadın İç Giyim</option>
          <option value="BGT8 - Kadın İnternet Giyim">BGT8 - Kadın İnternet Giyim</option>
          <option value="BGU8 - Outlet Kadın Aksesuar">BGU8 - Outlet Kadın Aksesuar</option>
          <option value="BGV8 - Kadın Natuvera">BGV8 - Kadın Natuvera</option>
          <option value="BGW8 - Kadın Koor">BGW8 - Kadın Koor</option>
          <option value="BGX8 - Kadın Casual">BGX8 - Kadın Casual</option>
          <option value="BGY8 - Kadın E-Ticaret Özel Üretim">BGY8 - Kadın E-Ticaret Özel Üretim</option>
          <option value="BGZ8 - Kadın Geleneksel">BGZ8 - Kadın Geleneksel</option>
          <option value="BUA8 - Erkek Ayakkabı">BUA8 - Erkek Ayakkabı</option>
          <option value="BUB8 - Erkek Southblue">BUB8 - Erkek Southblue</option>
          <option value="BUC8 - Erkek Klasik">BUC8 - Erkek Klasik</option>
          <option value="BUE8 - Erkek Klasik">BUE8 - Erkek Klasik</option>
          <option value="BUF8 - Erkek Vision Mısır">BUF8 - Erkek Vision Mısır</option>
          <option value="BUG8 - Erkek Aktif Giyim">BUG8 - Erkek Aktif Giyim</option>
          <option value="BUI8 - Erkek İkinci El Ürün">BUI8 - Erkek İkinci El Ürün</option>
          <option value="BUJ8 - Erkek Denim">BUJ8 - Erkek Denim</option>
          <option value="BUK8 - Erkek Aksesuar">BUK8 - Erkek Aksesuar</option>
          <option value="BUL8 - Erkek Vision / Smart Trendy">BUL8 - Erkek Vision / Smart Trendy</option>
          <option value="BUM8 - Erkek Dış Giyim">BUM8 - Erkek Dış Giyim</option>
          <option value="BUN8 - Erkek Klasik NOS">BUN8 - Erkek Klasik NOS</option>
          <option value="BUO8 - Erkek Outlet Ürün">BUO8 - Erkek Outlet Ürün</option>
          <option value="BUQ8 - Erkek X-SIDE">BUQ8 - Erkek X-SIDE</option>
          <option value="BUR8 - Erkek Çorap">BUR8 - Erkek Çorap</option>
          <option value="BUS8 - Erkek İç Giyim">BUS8 - Erkek İç Giyim</option>
          <option value="BUT8 - Erkek İnternet Giyim">BUT8 - Erkek İnternet Giyim</option>
          <option value="BUU8 - Outlet Erkek Aksesuar">BUU8 - Outlet Erkek Aksesuar</option>
          <option value="BUV8 - Erkek Natuvera">BUV8 - Erkek Natuvera</option>
          <option value="BUW8 - Erkek Klasik Duvar">BUW8 - Erkek Klasik Duvar</option>
          <option value="BUX8 - Erkek Casual Trendy">BUX8 - Erkek Casual Trendy</option>
          <option value="BUY8 - Erkek E-Ticaret Özel Üretim">BUY8 - Erkek E-Ticaret Özel Üretim</option>
          <option value="CK1 - Kız Bebek Aksesuar">CK1 - Kız Bebek Aksesuar</option>
          <option value="CKA1 - Kız Bebek Ayakkabı">CKA1 - Kız Bebek Ayakkabı</option>
          <option value="CKA4 - Kız Çocuk Ayakkabı">CKA4 - Kız Çocuk Ayakkabı</option>
          <option value="CKA6 - Kız Genç Aksesuar">CKA6 - Kız Genç Aksesuar</option>
          <option value="CKB1 - Kız Bebek Yenidoğan">CKB1 - Kız Bebek Yenidoğan</option>
          <option value="CKB4 - Kız Çocuk Southblue">CKB4 - Kız Çocuk Southblue</option>
          <option value="CKBD - Kız Bebek Oyuncak-Standart Dışı">CKBD - Kız Bebek Oyuncak-Standart Dışı</option>
          <option value="CKD4 - Kız Çocuk Natuvera">CKD4 - Kız Çocuk Natuvera</option>
          <option value="CKI4 - Kız Çocuk İkinci El Ürün">CKI4 - Kız Çocuk İkinci El Ürün</option>
          <option value="CKK1 - Kız Bebek Aksesuar">CKK1 - Kız Bebek Aksesuar</option>
          <option value="CKK4 - Kız Çocuk Aksesuar">CKK4 - Kız Çocuk Aksesuar</option>
          <option value="CKO1 - Kız Bebek Outlet Ürün">CKO1 - Kız Bebek Outlet Ürün</option>
          <option value="CKO4 - Kız Çocuk Outlet Ürün">CKO4 - Kız Çocuk Outlet Ürün</option>
          <option value="CKR1 - Kız Bebek Çorap">CKR1 - Kız Bebek Çorap</option>
          <option value="CKR4 - Kız Çocuk Çorap">CKR4 - Kız Çocuk Çorap</option>
          <option value="CKS1 - Kız Bebek İç Giyim">CKS1 - Kız Bebek İç Giyim</option>
          <option value="CKS4 - Kız Çocuk İç Giyim">CKS4 - Kız Çocuk İç Giyim</option>
          <option value="CKS6 - Kız Genç İç Giyim">CKS6 - Kız Genç İç Giyim</option>
          <option value="CKT1 - Kız Bebek İnternet Giyim">CKT1 - Kız Bebek İnternet Giyim</option>
          <option value="CKT4 - Kız Çocuk İnternet Giyim">CKT4 - Kız Çocuk İnternet Giyim</option>
          <option value="CKU1 - Outlet Kız Bebek Aksesuar">CKU1 - Outlet Kız Bebek Aksesuar</option>
          <option value="CKU4 - Outlet Kız Çocuk Aksesuar">CKU4 - Outlet Kız Çocuk Aksesuar</option>
          <option value="CKW1 - Kız Bebek">CKW1 - Kız Bebek</option>
          <option value="CKW4 - Kız Çocuk">CKW4 - Kız Çocuk</option>
          <option value="CKW6 - Kız Genç">CKW6 - Kız Genç</option>
          <option value="CKY1 - Kız Bebek E-Ticaret Özel Üretim">CKY1 - Kız Bebek E-Ticaret Özel Üretim</option>
          <option value="CKY4 - Kız Çocuk E-Ticaret Özel Üretim">CKY4 - Kız Çocuk E-Ticaret Özel Üretim</option>
          <option value="CU1 - Erkek Bebek Aksesuar">CU1 - Erkek Bebek Aksesuar</option>
          <option value="CUA1 - Erkek Bebek Ayakkabı">CUA1 - Erkek Bebek Ayakkabı</option>
          <option value="CUA4 - Erkek Çocuk Ayakkabı">CUA4 - Erkek Çocuk Ayakkabı</option>
          <option value="CUA6 - Erkek Genç Aksesuar">CUA6 - Erkek Genç Aksesuar</option>
          <option value="CUB1 - Erkek Bebek Yenidoğan">CUB1 - Erkek Bebek Yenidoğan</option>
          <option value="CUB4 - Erkek Çocuk Southblue">CUB4 - Erkek Çocuk Southblue</option>
          <option value="CUBD - Erkek Bebek Oyuncak-Standart Dışı">CUBD - Erkek Bebek Oyuncak-Standart Dışı</option>
          <option value="CUD4 - Erkek Çocuk Natuvera">CUD4 - Erkek Çocuk Natuvera</option>
          <option value="CUI4 - Erkek Çocuk İkinci El Ürün">CUI4 - Erkek Çocuk İkinci El Ürün</option>
          <option value="CUK1 - Erkek Bebek Aksesuar">CUK1 - Erkek Bebek Aksesuar</option>
          <option value="CUK4 - Erkek Çocuk Aksesuar">CUK4 - Erkek Çocuk Aksesuar</option>
          <option value="CUO1 - Erkek Bebek Outlet Ürün">CUO1 - Erkek Bebek Outlet Ürün</option>
          <option value="CUO4 - Erkek Çocuk Outlet Ürün">CUO4 - Erkek Çocuk Outlet Ürün</option>
          <option value="CUR1 - Erkek Bebek Çorap">CUR1 - Erkek Bebek Çorap</option>
          <option value="CUR4 - Erkek Çocuk Çorap">CUR4 - Erkek Çocuk Çorap</option>
          <option value="CUS1 - Erkek Bebek İç Giyim">CUS1 - Erkek Bebek İç Giyim</option>
          <option value="CUS4 - Erkek Çocuk İç Giyim">CUS4 - Erkek Çocuk İç Giyim</option>
          <option value="CUS6 - Erkek Genç İç Giyim">CUS6 - Erkek Genç İç Giyim</option>
          <option value="CUT1 - Erkek Bebek İnternet Giyim">CUT1 - Erkek Bebek İnternet Giyim</option>
          <option value="CUT4 - Erkek Çocuk İnternet Giyim">CUT4 - Erkek Çocuk İnternet Giyim</option>
          <option value="CUU1 - Outlet Erkek Bebek Aksesuar">CUU1 - Outlet Erkek Bebek Aksesuar</option>
          <option value="CUU4 - Outlet Erkek Çocuk Aksesuar">CUU4 - Outlet Erkek Çocuk Aksesuar</option>
          <option value="CUV4 - Erkek Çocuk Vision">CUV4 - Erkek Çocuk Vision</option>
          <option value="CUW1 - Erkek Bebek">CUW1 - Erkek Bebek</option>
          <option value="CUW4 - Erkek Çocuk">CUW4 - Erkek Çocuk</option>
          <option value="CUW6 - Erkek Genç">CUW6 - Erkek Genç</option>
          <option value="CUY1 - Erkek Bebek E-Ticaret Özel Üretim">CUY1 - Erkek Bebek E-Ticaret Özel Üretim</option>
          <option value="CUY4 - Erkek Çocuk E-Ticaret Özel Üretim">CUY4 - Erkek Çocuk E-Ticaret Özel Üretim</option>
          <option value="ETA9 - E-Ticaret Aksesuar">ETA9 - E-Ticaret Aksesuar</option>
          <option value="ETD9 - Ev Tekstil Dışı">ETD9 - Ev Tekstil Dışı</option>
          <option value="EVD9 - Ev Tekstil Dışı">EVD9 - Ev Tekstil Dışı</option>
          <option value="EVE9 - EV İnternet Giyim">EVE9 - EV İnternet Giyim</option>
          <option value="EVO9 - Ev Outlet Ürün">EVO9 - Ev Outlet Ürün</option>
          <option value="EVT9 - Ev Tekstilli">EVT9 - Ev Tekstilli</option>
          <option value="KA - Konsinye Aksesuar">KA - Konsinye Aksesuar</option>
          <option value="KA1B - Konsinye Bebek Aksesuar">KA1B - Konsinye Bebek Aksesuar</option>
          <option value="KAZ1 - Konsinye Aksesuar">KAZ1 - Konsinye Aksesuar</option>
          <option value="MAS0 - Maske Giyim">MAS0 - Maske Giyim</option>
          <option value="ST9 - Standar Dışı Aksesuar">ST9 - Standar Dışı Aksesuar</option>
        </select>
        <div id="selected1" class="selected-items"></div>
      </div>
      <div>
        <label for="select2">Select 2</label>
        <select id="select2" onchange="displaySelectedItems()">
          <option value="">Select...</option>
          <option value="DENİM">DENİM</option>
          <option value="DIŞ GİYİM">DIŞ GİYİM</option>
          <option value="DOKUMA ALT">DOKUMA ALT</option>
          <option value="DOKUMA ÜST">DOKUMA ÜST</option>
          <option value="LİSANS">LİSANS</option>
          <option value="ÖRME">ÖRME</option>
          <option value="ÖRME ALT">ÖRME ALT</option>
          <option value="TRİKO">TRİKO</option>
          <option value="YÜZME GİYİM">YÜZME GİYİM</option>
        </select>
        <div id="selected2" class="selected-items"></div>
      </div>
      <div>
        <label for="select3">Select 3</label>
        <select id="select3" onchange="displaySelectedItems()">
          <option value="">Select...</option>
          <option value="ZARA">ZARA</option>
          <option value="PULL&BEAR">PULL&BEAR</option>
          <option value="MASSIMO DUTTI">MASSIMO DUTTI</option>
          <option value="BERSHKA">BERSHKA</option>
          <option value="STRADIVARIUS">STRADIVARIUS</option>
          <option value="HM">HM</option>
          <option value="MARKS&SPENCER">MARKS&SPENCER</option>
        </select>
        <div id="selected3" class="selected-items"></div>
      </div>
    </div>

    <div id="all-counters"></div> <!-- Dinamik sayaç setleri burada oluşturulacak -->

    <div>
      <h1>Overall Total</h1>
      <div id="overall-total">0</div>
    </div>

    <button id="download-btn" onclick="downloadExcel()">İndir</button>
  </center>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
  <script>
    const numSets = 5; // Kaç tane sayaç seti oluşturulacağı
    const allCounters = document.getElementById('all-counters');
    let debounceTimer;

    // Tarayıcıda depolanan sayaç ve girdi değerlerini yükle
    function loadState() {
      const select1 = document.getElementById('select1').value;
      const select2 = document.getElementById('select2').value;
      const select3 = document.getElementById('select3').value;
      if (!select1 || !select2 || !select3) return;

      allCounters.innerHTML = '';

      for (let i = 1; i <= numSets; i++) {
        const trendadiId = `trendadi_${select1}_${select2}_${select3}_${i}`;
        const trendId = `trend-value_${select1}_${select2}_${select3}_${i}`;
        const keyId = `key-value_${select1}_${select2}_${select3}_${i}`;
        const timeId = `time-value_${select1}_${select2}_${select3}_${i}`;
        const nosId = `nos-value_${select1}_${select2}_${select3}_${i}`;
        const totalId = `set-total_${select1}_${select2}_${select3}_${i}`;

        const savedTrendadi = localStorage.getItem(trendadiId) || `TREND&KUMAŞ ${i}`;
        const savedTrend = parseInt(localStorage.getItem(trendId), 10) || 0;
        const savedKey = parseInt(localStorage.getItem(keyId), 10) || 0;
        const savedTime = parseInt(localStorage.getItem(timeId), 10) || 0;
        const savedNos = parseInt(localStorage.getItem(nosId), 10) || 0;
        const setTotal = savedTrend + savedKey + savedTime + savedNos;

        // Sayaç seti HTML'sini oluştur
        const counterSet = `
          <input type="text" id="${trendadiId}" name="${trendadiId}" value="${savedTrendadi}" class="input-number" oninput="saveInput('${trendadiId}', this.value)"><br>
          <div class="mounter-container">
            <div class="mounter">
              <h1>TREND</h1>
              <div id="${trendId}">${savedTrend}</div>
              <button onclick="changeValue('${trendId}', -1, '${totalId}', event)">-</button>
              <button onclick="changeValue('${trendId}', 1, '${totalId}', event)">+</button>
            </div>

            <div class="mounter">
              <h1>KEY</h1>
              <div id="${keyId}">${savedKey}</div>
              <button onclick="changeValue('${keyId}', -1, '${totalId}', event)">-</button>
              <button onclick="changeValue('${keyId}', 1, '${totalId}', event)">+</button>
            </div>

            <div class="mounter">
              <h1>TIME</h1>
              <div id="${timeId}">${savedTime}</div>
              <button onclick="changeValue('${timeId}', -1, '${totalId}', event)">-</button>
              <button onclick="changeValue('${timeId}', 1, '${totalId}', event)">+</button>
            </div>

            <div class="mounter">
              <h1>NOS</h1>
              <div id="${nosId}">${savedNos}</div>
              <button onclick="changeValue('${nosId}', -1, '${totalId}', event)">-</button>
              <button onclick="changeValue('${nosId}', 1, '${totalId}', event)">+</button>
            </div>
          </div>
          <h2>Set Total: <span id="${totalId}" class="total">${setTotal}</span>
          <button class="reset-button" onclick="resetSet(${i}, '${totalId}', '${select1}', '${select2}', '${select3}')">Reset</button></h2><br>
        `;

        // Tüm seti sayfaya ekle
        allCounters.innerHTML += counterSet;
      }

      updateOverallTotal(); // Sayfa yüklenirken genel toplam güncellenir
    }

    // Sayaç değerini değiştir ve ilgili set toplamını güncelle
    function changeValue(id, delta, totalId, event) {
      event.preventDefault(); // Zoom olayını engelle

      if (debounceTimer) {
        clearTimeout(debounceTimer);
      }

      debounceTimer = setTimeout(() => {
        let element = document.getElementById(id);
        let currentValue = parseInt(element.innerText, 10);
        let newValue = currentValue + delta;

        if (newValue < 0) {
          newValue = 0;
        }

        element.innerText = newValue;
        localStorage.setItem(id, newValue); // Değeri yerel depoda sakla
        updateSetTotal(totalId);
      }, 50); // 50 ms gecikme ile debouncing
    }

    // Girdi alanındaki değeri yerel depoda sakla
    function saveInput(inputId, value) {
      localStorage.setItem(inputId, value);
    }

    // Belirtilen sayaç setinin toplamını güncelle
    function updateSetTotal(totalId) {
      const select1 = document.getElementById('select1').value;
      const select2 = document.getElementById('select2').value;
      const select3 = document.getElementById('select3').value;
      const prefix = `_${select1}_${select2}_${select3}_`;
      const index = totalId.split('_').pop();
      const trend = parseInt(document.getElementById(`trend-value${prefix}${index}`).innerText, 10);
      const key = parseInt(document.getElementById(`key-value${prefix}${index}`).innerText, 10);
      const time = parseInt(document.getElementById(`time-value${prefix}${index}`).innerText, 10);
      const nos = parseInt(document.getElementById(`nos-value${prefix}${index}`).innerText, 10);

      const setTotal = trend + key + time + nos;
      document.getElementById(totalId).innerText = setTotal;

      updateOverallTotal();
    }

    // Bir setin tüm sayaçlarını sıfırla
    function resetSet(index, totalId, select1, select2, select3) {
      const prefix = `_${select1}_${select2}_${select3}_`;
      const trendadiId = `trendadi${prefix}${index}`;
      const trendId = `trend-value${prefix}${index}`;
      const keyId = `key-value${prefix}${index}`;
      const timeId = `time-value${prefix}${index}`;
      const nosId = `nos-value${prefix}${index}`;

      document.getElementById(trendadiId).value = `TREND&KUMAŞ ${index}`;
      document.getElementById(trendId).innerText = 0;
      document.getElementById(keyId).innerText = 0;
      document.getElementById(timeId).innerText = 0;
      document.getElementById(nosId).innerText = 0;

      localStorage.setItem(trendadiId, `TREND&KUMAŞ ${index}`);
      localStorage.setItem(trendId, 0);
      localStorage.setItem(keyId, 0);
      localStorage.setItem(timeId, 0);
      localStorage.setItem(nosId, 0);

      document.getElementById(totalId).innerText = 0;
      updateOverallTotal();
    }

    // Tüm sayaç setlerinin toplamını hesapla
    function updateOverallTotal() {
      const select1 = document.getElementById('select1').value;
      const select2 = document.getElementById('select2').value;
      const select3 = document.getElementById('select3').value;
      let overallTotal = 0;

      for (let i = 1; i <= numSets; i++) {
        const prefix = `_${select1}_${select2}_${select3}_`;
        const trend = parseInt(document.getElementById(`trend-value${prefix}${i}`).innerText, 10);
        const key = parseInt(document.getElementById(`key-value${prefix}${i}`).innerText, 10);
        const time = parseInt(document.getElementById(`time-value${prefix}${i}`).innerText, 10);
        const nos = parseInt(document.getElementById(`nos-value${prefix}${i}`).innerText, 10);

        overallTotal += trend + key + time + nos;
      }

      document.getElementById('overall-total').innerText = overallTotal;
    }

    // Seçilen öğeleri göster
    function displaySelectedItems() {
      const select1 = document.getElementById('select1').value;
      const select2 = document.getElementById('select2').value;
      const select3 = document.getElementById('select3').value;

      if (select1 && select2 && select3) {
        document.getElementById('selected1').innerText = `Selected: ${select1}`;
        document.getElementById('selected2').innerText = `Selected: ${select2}`;
        document.getElementById('selected3').innerText = `Selected: ${select3}`;
        document.getElementById('all-counters').style.display = 'block';
        loadState();
      } else {
        document.getElementById('selected1').innerText = '';
        document.getElementById('selected2').innerText = '';
        document.getElementById('selected3').innerText = '';
        document.getElementById('all-counters').style.display = 'none';
      }
    }

    // Excel dosyasını indir
    function downloadExcel() {
      const select1 = document.getElementById('select1').value;
      const select2 = document.getElementById('select2').value;
      const select3 = document.getElementById('select3').value;
      const data = [];

      for (let i = 1; i <= numSets; i++) {
        const prefix = `_${select1}_${select2}_${select3}_`;
        const trendadi = document.getElementById(`trendadi${prefix}${i}`).value;
        const trend = parseInt(document.getElementById(`trend-value${prefix}${i}`).innerText, 10);
        const key = parseInt(document.getElementById(`key-value${prefix}${i}`).innerText, 10);
        const time = parseInt(document.getElementById(`time-value${prefix}${i}`).innerText, 10);
        const nos = parseInt(document.getElementById(`nos-value${prefix}${i}`).innerText, 10);
        const zaman = new Date().toLocaleString();

        data.push({ 'Select 1': select1, 'Select 2': select2, 'Select 3': select3, 'TREND&KUMAŞ': trendadi, 'TREND': trend, 'KEY': key, 'TIME': time, 'NOS': nos, 'ZAMAN': zaman });
      }

      const ws = XLSX.utils.json_to_sheet(data);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Sheet1");

      XLSX.writeFile(wb, "data.xlsx");
    }

    window.onload = displaySelectedItems;
  </script>

</body>
</html>
